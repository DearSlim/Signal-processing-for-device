#include <stdio.h>
#include <math.h>
#include "signalProcessing.h"
#include <stdbool.h>
#include <stdlib.h>

//产生方波数据
int setRectangularWave()
{
	bool mark = true;
	int count = 0;
	for (int i = 0; i < 64; i++)
	{
		if (count == 5)
		{
			mark = !mark;
			count = 0;
		}
		if (mark == true)
		{
			x[i].real = 5;
			count++;
		}
		else if (mark == false)
		{
			x[i].real = 0;
			count++;
		}
		x[i].img = 0;
		//printf("%f+j%f\n", x[i].real, x[i].img);
	}
	return 0;
}

//产生脉冲函数数据
int setPulseWave()
{
	x[0].real = 1;
	x[0].img = 0;
	for (int i = 1; i < 64; i++)
	{
		x[i].real = 0;
		x[i].img = 0;
	}
	return 0;
}

//产生三角波数据
int setTriangleWave()
{
	x[0].real = 0;
	int mark = 1;
	for (int i = 1; i < 64; i++)
	{
		if (i > 0 && x[i - 1].real == 5)
		{
			mark = -1;
		}
		else if (i > 0 && x[i - 1].real == 0)
		{
			mark = 1;
		}
		x[i].real = x[i - 1].real + mark;
		printf("%f\n", x[i].real);
	}
	for (int i = 0; i < 64; i++)
	{
		x[i].img = 0;
	}
	//for (int i = 0; i < 64; i++)
	//{
	//	printf("%f+j%f\n", x[i].real, x[i].img);
	//}
	return 0;
}


//Creat sin wave
void setSin()
{
	for (int i = 0; i < 64; i++)
	{
		x[i].real = sin(2*PI*5*0.05*i);
		x[i].img = 0;
	}
	
}

//Create a signal for corresponding test of coefficient.
double * setTest()
{
	double * testArray = (double *)calloc(64, sizeof(double));
	for (int i = 0; i < 64; i++)
	{
		testArray[i] = 0;
	}
	testArray[16] =testArray[48]= 1;
	return testArray;
}

//Create a array combined with noise for corresponding test of coefficient
double * setTest1()
{
	double * testArray = (double *)malloc(64 * sizeof(double));
	double f[64] = {0.098637456,
	0.029500652,
	0.094357695,
	0.129380317,
	0.165378737,
	0.18366426,
	0.14893466,
	0.022136653,
	0.126346583,
	0.131214481,
	0.144001099,
	0.179599972,
	0.027914314,
	0.049723573,
	0.128163523,
	0.13952503,
	1.184083785,
	0.011598286,
	0.018705145,
	0.021947573,
	0.121982194,
	0.031212536,
	0.041788402,
	0.095570213,
	0.175805198,
	0.102893555,
	0.011716358,
	0.093698182,
	0.107763802,
	0.086455655,
	0.100133362,
	0.157348852,
	0.181513112,
	0.050651883,
	0.043182906,
	0.059767073,
	0.026643288,
	0.160804325,
	0.103017002,
	0.016730334,
	0.115313695,
	0.074480089,
	0.082940938,
	0.031338249,
	0.018581717,
	0.131756304,
	0.082287669,
	0.081855058,
	1.014466837,
	0.188605839,
	0.109114987,
	0.120433959,
	0.153060777,
	0.160264496,
	0.054701578,
	0.196516527,
	0.062373435,
	0.100281002,
	0.005048123,
	0.157321713,
	0.074793542,
	0.143329967,
	0.011773381,
	0.17460074 };
	for (int i = 0; i < 64; i++)
	{
		testArray[i] = f[i];
	}
	return testArray;
}

//AB signals
double * Variaresp_AB_frequency()
{
	double f[104] = { 0,
0.00976563,
0.0195313,
0.0292969,
0.0390625,
0.0488281,
0.0585938,
0.0683594,
0.078125,
0.0878906,
0.0976563,
0.107422,
0.117188,
0.126953,
0.136719,
0.146484,
0.15625,
0.166016,
0.175781,
0.185547,
0.195313,
0.205078,
0.214844,
0.224609,
0.234375,
0.244141,
0.253906,
0.263672,
0.273438,
0.283203,
0.292969,
0.302734,
0.3125,
0.322266,
0.332031,
0.341797,
0.351563,
0.361328,
0.371094,
0.380859,
0.390625,
0.400391,
0.410156,
0.419922,
0.429688,
0.439453,
0.449219,
0.458984,
0.46875,
0.478516,
0.488281,
0.498047,
0.507813,
0.517578,
0.527344,
0.537109,
0.546875,
0.556641,
0.566406,
0.576172,
0.585938,
0.595703,
0.605469,
0.615234,
0.625,
0.634766,
0.644531,
0.654297,
0.664063,
0.673828,
0.683594,
0.693359,
0.703125,
0.712891,
0.722656,
0.732422,
0.742188,
0.751953,
0.761719,
0.771484,
0.78125,
0.791016,
0.800781,
0.810547,
0.820313,
0.830078,
0.839844,
0.849609,
0.859375,
0.869141,
0.878906,
0.888672,
0.898438,
0.908203,
0.917969,
0.927734,
0.9375,
0.947266,
0.957031,
0.966797,
0.976563,
0.986328,
0.996094,
1.00586 };
return f;
}
//Collected data for calculation of correlation coefficient, corresponding frequency ranges from 0-1hz
double * AS_Effort_Sans()
{
	double * testArray = (double *)calloc(104, sizeof(double));
	double f[104] = { 4.07388230519528,
7.78929835244811,
8.23985462697529,
6.35535572218109,
6.45856172349366,
9.3018870596552,
8.6413686512547,
6.52436524914258,
3.07404506804321,
4.37242312365379,
5.85478721619077,
5.52425641725022,
7.11921592926431,
10.1749477519618,
8.4111339099807,
4.65876157842327,
7.33266999551287,
8.37990051484663,
6.46731095405606,
4.07780102930527,
3.84025262966757,
6.51548022121004,
8.81681885348608,
11.3472670488263,
18.0961635496967,
18.4912562983305,
20.3247923900706,
23.7490200764772,
22.8587713170347,
32.847831868888,
37.2641563423483,
33.8077252795922,
41.3580590598282,
27.1664578943764,
36.0458599358765,
43.3816338712784,
20.4390561772381,
19.451421303775,
16.6686421950753,
8.93428357866422,
10.414610710649,
10.5276135222365,
12.3885612831222,
6.64464291984521,
6.94902302522009,
5.16741972774955,
4.18628372842932,
4.35275190460661,
4.21996147622605,
2.80557366726036,
3.51495972928988,
2.65031847393243,
2.46968857201111,
3.54400096687728,
4.63197069725548,
4.3826079264149,
4.12015040916718,
3.42389789279341,
3.11018656812692,
3.60761233497952,
4.08012898422209,
3.8298738306634,
3.46756644710818,
3.36686299733119,
4.25726695376817,
4.95105571785497,
4.36053115395367,
4.76476112563604,
3.80599289314163,
4.64419246056881,
3.02001711434856,
1.94042802167093,
1.34490223462332,
0.954153061871804,
1.42601982370009,
1.66598347656399,
2.19078017335116,
2.32663574237221,
1.6205185170384,
2.83154976420727,
2.35177765547392,
1.97152561943485,
1.67712080087857,
1.89851125343107,
1.69216520952855,
1.46775229550905,
1.57657448805846,
2.07381983840501,
2.51609247335316,
1.56756336256792,
1.53053723961582,
1.61239589434111,
1.4039954302245,
1.67528171649428,
1.05849006128147,
1.05578187372823,
1.431956108738,
1.79728789372265,
2.11304587875351,
1.88797919739486,
1.94116520739459,
1.71955165916257,
1.24961321999038,
1.14094428447299 };
	for (int i = 0; i < 104; i++)
	{
		testArray[i] = f[i];
	}
	return testArray;
}

double * AB_recupSans()
{
	double * testArray = (double *)calloc(104, sizeof(double));
	double f[104] = { 6.4055513858752,
20.2579296125507,
17.8605743256069,
20.2300398050342,
15.3107742268975,
15.866088038339,
12.7620692776978,
13.010230156621,
13.1868412675698,
7.79709946001828,
14.2425653950277,
10.5310306963107,
12.2812986428907,
13.8129017373452,
13.2702186502501,
12.0920568075954,
15.2408306782042,
15.7717591605606,
17.9925033365555,
22.2809627970411,
23.9479993808755,
17.8659040532213,
20.8371906932734,
25.9217508374243,
28.087591517994,
31.5356332446506,
32.9590355675357,
28.031811902961,
13.8915334721496,
15.6758970734685,
20.8144115834694,
15.0276415736276,
16.5742117113828,
11.2186385685374,
18.364781159924,
11.6548731232788,
9.83597580741723,
10.3530323959827,
9.0560833364971,
6.89157143733263,
8.98599376786919,
11.0732027136345,
11.0475762151049,
7.54813547145456,
8.04328906982381,
14.5256980482976,
15.2988005922569,
8.9370770897643,
14.088076304177,
12.2558911742631,
7.73642817717475,
7.69546958550781,
9.37170542522465,
9.4848708745718,
7.23707650568456,
5.00367240135623,
7.66575452880827,
7.41584141066939,
6.79946936355751,
6.84717407620488,
6.82062035109033,
8.51091791051314,
4.81860673619163,
5.03530762019631,
5.55527730645788,
4.61435405161513,
4.38090468110707,
3.63500565097147,
4.19102765909602,
5.54475657016696,
5.19625809315488,
4.14600971324605,
4.18482181187376,
5.53200902987276,
4.56798542136973,
4.59600664682743,
3.09949944366405,
5.07558721916716,
5.39941562822156,
3.53793889941855,
4.20585598345886,
3.80957978383209,
2.90525642560722,
2.82286467748577,
2.42428136289166,
2.26840508266189,
1.74590925153102,
2.02304778648381,
2.32558648906749,
2.06865711306908,
2.2484222546062,
3.16959631328869,
3.07169724810831,
2.74126873800811,
2.18098294779203,
2.32345459802172,
2.03580262777474,
1.66239314991283,
1.81480145669487,
2.43453196230349,
2.10386982030787,
1.75881741375333,
1.60233515079479 };
	for (int i = 0; i < 104; i++)
	{
		testArray[i] = f[i];
	}
	return testArray;
}

double * AS_reposSans()
{
	double * testArray = (double *)calloc(104, sizeof(double));
	double f[104] = { 17.8897159773309,
37.5468172820291,
26.3604262755362,
14.3208060846491,
13.0522161718944,
11.3609140134631,
10.8789364535326,
9.01381622814778,
10.2250542352651,
12.303469168534,
17.147766609845,
20.4592223378879,
25.857401220824,
46.4659701365173,
41.9361766483326,
49.3238473167276,
42.3357265791776,
22.7891497985128,
13.8987987789891,
14.099706683724,
16.6179034816431,
15.5843103587125,
10.0725857802432,
13.1721566804354,
15.9908089840069,
14.2849044966601,
19.7123383902856,
20.8743313019567,
14.2663242919365,
14.5180885835842,
15.0849610626583,
13.2959240062094,
10.7067296780456,
9.18733217795141,
9.00384636219853,
8.61487053160275,
8.10968030398237,
8.46220066514755,
6.60518724995374,
5.60900630076192,
4.81121561338853,
6.53152101821761,
5.42501695642574,
3.7428236300663,
3.72340756789442,
3.02173041650047,
3.036906768001,
3.12785410071583,
2.39880010024811,
1.93585592076622,
2.1672575165055,
2.39871953567478,
2.20443806709604,
3.35487499778044,
3.023643825117,
2.28748503633897,
1.56079762021273,
2.31079840974555,
1.84766792468785,
1.61558656536112,
1.4339889817956,
1.28461722756098,
1.16887614740468,
1.24173673340754,
1.58145739798535,
1.5005302840781,
1.22287455267729,
1.05753590706638,
1.27347414001266,
1.26729080900979,
1.30775940124925,
1.32600224182204,
1.0746206318976,
0.954518994209952,
0.799230779121619,
0.966210927914074,
0.888058256500779,
0.839039748916962,
0.976951192595767,
0.824286361426403,
0.781743231423766,
0.714849459132959,
0.70880208084758,
0.629989786990168,
0.519591145102629,
0.605895944279478,
0.699391131625787,
0.656812754622319,
0.707966223399309,
0.542884377365879,
0.638000926750399,
0.678373848559033,
0.475611951580433,
0.349898487831962,
0.568035630101489,
0.641127839252664,
0.620684578770867,
0.664884317812546,
0.635161025540613,
0.538342549544554,
0.685906636165133,
0.564062789579288,
0.707024624948547 };
	for (int i = 0; i < 104; i++)
	{
		testArray[i] = f[i];
	}
	return testArray;
}

double * JF_effort_sans()
{
	double * testArray = (double *)calloc(104, sizeof(double));
	double f[104] = { 4.45706530661577,
13.4662451627612,
10.0354680315149,
11.7432823192129,
11.1432988702814,
10.0368451729558,
9.17832990197755,
9.27231980532154,
8.16313830860337,
9.61088473187817,
9.51832493695363,
9.12536292347996,
11.2330514153456,
12.9009815682349,
8.73078541716211,
8.25516843374294,
10.7994637293642,
11.5924058809625,
9.11762974461931,
8.75393198676556,
11.6356004519273,
8.94519574612038,
8.47765622692209,
10.1698982229418,
9.75723249346704,
9.55132336455763,
8.20326079481529,
10.9665480630349,
9.52242987778719,
5.88283043381408,
7.32173137167979,
9.02173303004941,
11.8310486025834,
12.7380021753978,
8.95541837297042,
8.52731276926359,
14.1213672363088,
13.5842820743431,
15.4335976450975,
11.470899632289,
24.2603857107865,
21.3276041113746,
24.9547298319115,
35.7307291898013,
31.1075064716386,
28.2907225551364,
24.2099611472568,
11.6398907771856,
11.7447124276324,
9.4517719284714,
6.35206489632429,
5.8084912794927,
5.33536374406292,
3.961691640217,
3.15857982874719,
2.58588496713762,
3.26639411347904,
4.84896798051949,
3.95989076294808,
3.46766863176991,
3.49695937087908,
3.06249772975255,
3.11954316559446,
3.52275428940741,
3.15137631967151,
3.25023918503728,
1.65912704106302,
2.21465265659259,
3.52797153678943,
3.45694281862415,
2.21933493749178,
2.82457006234134,
2.3207481628722,
1.96281586062792,
1.43988612366577,
2.26390400154858,
2.36827013598024,
1.79584805430994,
1.6765929022226,
1.83212248953402,
2.41167657485903,
2.93656873837451,
2.22994687163377,
1.70513151023711,
2.42019631335036,
2.70486469093677,
2.980902099377,
2.75891749249357,
3.16128114465056,
2.98249110873193,
2.58032078604645,
2.45771017587129,
2.03500455562229,
1.97120583002194,
2.69551601923195,
2.75211123575663,
1.85669122251013,
1.52472068477644,
1.78611007531316,
2.24502921876096,
2.2166654017755,
2.26897823808865,
1.52161946818541 };
	for (int i = 0; i < 104; i++)
	{
		testArray[i] = f[i];
	}
	return testArray;
}

double * JF_repos_sans()
{
	double * testArray = (double *)calloc(104, sizeof(double));
	double f[104] = { 1.39297060770537,
13.3309511885569,
15.5792149765092,
11.7254186368441,
16.8664048341696,
18.2593250598072,
17.9009646090528,
11.5087037709631,
7.49087781344921,
10.2994621696126,
11.151278987182,
9.67062198920667,
9.94254120650935,
5.07287683911126,
2.55438523184638,
6.40618788111463,
5.90690878675069,
1.66515613022352,
3.48403514671359,
4.75647745338798,
1.99099855493836,
2.12034371783266,
4.49546235504278,
5.09126629385474,
2.64762804444977,
3.17379676813724,
1.16782034418863,
1.41159038047303,
0.848822683255012,
0.511474433744503,
1.03093946344055,
1.92860396269917,
1.88490831504844,
2.71380129177324,
1.91955678281167,
2.81375211683101,
1.00728148389386,
0.74827447082202,
0.526756754392962,
0.536261691353521,
1.49674327247695,
0.433100089089862,
1.03914454305212,
0.75002344831817,
0.43287912773541,
1.09673124653647,
0.583621554820259,
0.475660700727658,
0.740306906672892,
0.607660998594504,
0.277770734604615,
0.849088988470476,
1.15459145267454,
0.631411105350867,
0.363415931385227,
0.263181527260186,
0.82877062027446,
0.640507947562324,
0.549522971339762,
0.632949917649949,
0.482153509778181,
0.455127129127795,
0.361941176286622,
0.94696695131058,
0.19207731498769,
0.534329898925675,
0.382616537420123,
0.521054943806748,
0.894065780130731,
0.518411324735407,
0.489527285271209,
0.168507863931546,
0.287806842508449,
0.318592445159819,
0.553490199306338,
0.745525049408319,
0.562332252203542,
0.187537890679781,
0.510253028472501,
0.428641276090417,
0.42297905141461,
0.428882390271985,
0.389459141969876,
0.473613749287719,
0.149346124063232,
0.185074927308659,
0.261482931831826,
0.209474962739517,
0.100042232523612,
0.0600599591921776,
0.101516267878392,
0.119951786226701,
0.0104470096538557,
0.166891319299302,
0.255968254640262,
0.185203761453437,
0.185765881381212,
0.0949385290564516,
0.10805226155845,
0.0606839051145696,
0.195483142770316,
0.019515709881733,
0.130455007873334 };
	for (int i = 0; i < 104; i++)
	{
		testArray[i] = f[i];
	}
	return testArray;
}
